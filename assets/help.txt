   【 自由配置メモ帳 (Free-form Memo Editor) 】
   ============================================

   ■ 1. 概要 (Overview)
      「紙のメモ帳」のように、画面の好きな場所から文字を書けるテキストエディタ。
      一般的なエディタの制約（行縛り）をなくし、人間の感覚に近い記述や加工を実現する。
      テキストの上に透明なシートがあり、文字を汚さずに枠線などの飾りも描画できる。

   ■ 2. テキスト操作 (Text Editing)

      [ 基本操作 (Standard) ]
        既存エディタと同様の操作です。
        ・入力・削除      : 通常の文字入力、Backspace / Delete での削除。
        ・範囲選択        : ドラッグ で、行や文章を通常通り選択 (色は青)。
        ・編集            : コピー(Ctrl+C)、貼り付け(Ctrl+V)、切り取り(Ctrl+X)。
        ・履歴            : 元に戻す(Ctrl+Z)、やり直し(Ctrl+Y)。

      [ 独自機能 (Unique Features) ]
        本ツール独自の機能です。

        1. 任意位置入力 (Free Cursor)
           クリック または Alt + 矢印キー で、文字のない場所へカーソルを移動。
           (移動した空間には自動的にスペースが挿入されます)

           [例] 行末より右側をクリック
           Hello World!                [ I ] <-- ここをクリック
                       ----------------->
                       (自動でスペース埋め)

        2. 矩形選択 (Rectangular Selection)
           Alt + ドラッグ で、四角い範囲をブロックとして選択 (色は緑)。
           列単位の編集や切り貼りに使用します。

           [イメージ]
           通常選択(行単位)           矩形選択(Alt+Drag)
           [ AAAAA ]                 [ AAA ] AA
           [ BBBBB ]                 [ BBB ] BB
           [ CCCCC ]                 [ CCC ] CC

           [操作]
           ・一括削除    : 選択して Delete (右側の文字が左に詰まる)
           ・一括入力    : 選択状態で文字入力 (全行に挿入)
           ・矩形コピー  : 選択範囲をコピー

        3. 矩形貼り付け (Rectangular Paste)
           Alt + Ctrl + V で、クリップボードの内容を矩形ブロックとして貼り付け。

        4. 整形 (Formatting)
           選択範囲を枠線で囲む、表組みに変換する。
           (メニューバーの「整形」から実行)

           [例] 表組み変換
           Name,Age       ┌──────┬─────┐
           Alice,20  ===> │Name  │Age  │
           Bob,25         └──────┴─────┘

   ■ 3. 装飾機能 (Decoration)
      テキストの上に透明なシートを重ね、枠線や矢印などを描画する機能。
      テキストファイル(.txt)のデータは変更せずに、見た目の強調や補足ができます。

      [ 図形の種類 ]
        ・線と矢印      : 直線、L字線 (始点・終点に矢印を設定可能)
        ・囲み枠        : 四角形、角丸四角形、楕円、強調吹き出し
        ・その他        : マーカー(半透明)、テーブル(表枠)、画像挿入

      [ 図形の属性 (Attributes) ]
        図形を選択中、ツールバーで以下の見た目を変更できます。

        ・色 (Color)    : [全図形] 線の色。(マーカーは塗りつぶし色)
        ・太さ (Width)  : [線・枠・表] 線の太さ。
        ・線種 (Style)  : [線・枠] 実線、点線、破線、二重線。
        ・矢印 (Arrow)  : [線・L字] 始点・終点に矢印を付与。
        ・経路 (Route)  : [L字] 折れ曲がる位置(上/下)を変更。
        ・余白 (Padding): [枠] 枠線と中の文字との間隔(X, Y)。
        ・高さ (Height) : [マーカー] 縦幅(%)。
        ・行列 (Grid)   : [テーブル] 行数と列数。

      [ 操作手順 ]
        1. 囲み枠 (矩形描画)
           文字を囲むようにドラッグして範囲を指定する。
           ・文字がある場合: 枠は文字の範囲に自動的にフィット(吸着)します。
           ・文字がない場合: マス目に沿って指定した通りの大きさになります。
           
           (挙動の注意点: 文字との連動)
           枠の「左上の角」と「右下の角」は、その位置の文字(マス目)に固定されます。
           ・[動く場合]   角にある文字(またはその前の文字)が移動すると、枠も一緒に変形します。
                          (文字入力で横に伸縮、改行で縦に伸縮します)
           ・[動かない場合] 枠の中や線上の文字を編集しても、枠は反応しません。

        2. 線・矢印 (線引き)
           ドラッグして、始点から終点へ線を引く。
           
           [ L字線 (Elbow) の特性 ]
           ・経路変更: 選択中、ツールバーの「経路(Route)」ボタンで、折れ曲がる位置(上/下)を切り替えられます。
           ・自動判定: 描画時のマウスの動き(横移動優先か縦移動優先か)によって、ある程度自動で経路が決まります。

        3. テーブル (表組み)
           囲み枠と同様にドラッグして範囲を指定する。
           
           [ テーブルの特性 ]
           ・行列変更: 選択中、ツールバーの「Rows」「Cols」で行数と列数を変更できます。
           ・罫線調整: 選択中、表の中の罫線にマウスを合わせるとカーソルが変化し、ドラッグして位置を調整できます。

        4. 画像 (配置)
           ドラッグして範囲を指定すると、ファイル選択画面が開きます。

        5. 共通操作 (選択・編集)
           ・選択       : 図形をクリック (ハンドル■が表示される)。
           ・移動       : 図形自体をドラッグ。
           ・変形       : ハンドル(■)をドラッグ。
           ・削除       : Deleteキー。
           ・属性変更   : 選択中にツールバーで色・太さ・線種を変更。
           
           (重ねて描画する場合)
           通常、図形の上でドラッグすると「移動」になります。
           図形の上に重ねて新規描画したい場合は、Ctrlキーを押しながらドラッグしてください。

   ============================================
     4. リファレンス (Reference)
   ============================================

   ■ 構造と仕様 (Structure & Spec)

      [ 2層構造 ]
         テキストデータと図形データを独立して管理する構造になっています。

         [ 図形シート ]    ────→   □   ○   (透明なシート)
               ＋
         [ テキスト ]      ────→   A B C   (テキストデータ)

      [ 保存形式 ]
         見た目は自由配置ですが、保存されるファイルは標準的なテキストファイル(.txt)です。
         文字のない空間は、保存時に半角スペースで自動的に埋められます。
         図形データはテキストファイルには含まれません。
         同名の "_draw.json" ファイルとして別途保存されます。

   ■ 操作一覧 (Key Bindings)
     
     [ 移動 ]
       移動              : 矢印 / クリック
       自由移動          : Alt + 矢印

     [ 編集 ]
       削除              : Backspace / Delete
       改行              : Enter
       モード切替        : Insert (上書き/挿入)
       元に戻す          : Ctrl + Z
       やり直し          : Ctrl + Y
       全選択            : Ctrl + A
       切り取り          : Ctrl + X
       コピー            : Ctrl + C
       貼り付け          : Ctrl + V
       矩形貼り付け      : Alt + Ctrl + V
       行末空白削除      : Alt + Ctrl + D

     [ 選択 ]
       範囲選択          : ドラッグ / Shift + 矢印
       矩形選択          : Alt + ドラッグ
       矩形選択(キー)    : Shift + Alt + 矢印

     [ 図形 ]
       描画              : ドラッグ (グリッド吸着)
       強制描画          : Ctrl + ドラッグ
       選択              : クリック
       変形              : ハンドル操作
       削除              : Delete

     [ ファイル ]
       ファイルを開く    : Ctrl + O
       保存              : Ctrl + S
       別名保存          : Ctrl + Shift + S
       検索              : Ctrl + F
       置換              : Ctrl + H